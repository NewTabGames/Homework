<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hmwk Tracker</title>
<style>
*{box-sizing:border-box;font-family:Segoe UI,sans-serif}
body{
margin:0;
background:linear-gradient(135deg,#667eea,#764ba2);
min-height:100vh;
display:flex;
justify-content:center;
align-items:center;
}
.container{
background:white;
border-radius:20px;
padding:30px;
width:100%;
max-width:650px;
}
.header h1{
text-align:center;
font-size:2.4rem;
background:linear-gradient(135deg,#667eea,#764ba2);
-webkit-background-clip:text;
-webkit-text-fill-color:transparent;
}
.clock{text-align:center;margin-bottom:15px}
#time{
font-size:1.6rem;
font-weight:600;
color:#333;
}

#date{
font-size:0.9rem;
color:#666;
}
.input-container{
display:flex;
gap:10px;
margin:20px 0;
flex-wrap:wrap;
}
.task-input,.due-input,select{
flex:1;
padding:12px;
border-radius:12px;
border:2px solid #ddd;
}
.add-btn{
padding:12px 22px;
border:none;
border-radius:12px;
background:linear-gradient(135deg,#667eea,#764ba2);
color:white;
cursor:pointer;
}
.filters,.course-filters{
display:flex;
justify-content:center;
gap:8px;
flex-wrap:wrap;
margin-top:10px;
}
.filter-btn,.course-tab{
padding:8px 14px;
border-radius:20px;
border:none;
cursor:pointer;
background:#eee;
}
.filter-btn.active{
background:linear-gradient(135deg,#667eea,#764ba2);
color:white;
}
.course-tab{
position:relative;
}
.course-tab.active{
background:linear-gradient(135deg,#667eea,#764ba2);
color:white;
}
.delete-course{
display:none;
margin-left:6px;
color:red;
cursor:pointer;
}
.course-tab:hover .delete-course{
display:inline;
}
.task-list,.archive-list{
list-style:none;
padding:0;
margin:0;
}
.task-item{
background:#f7f7f7;
padding:14px;
border-radius:12px;
display:flex;
align-items:center;
gap:10px;
margin-top:10px;
}
.task-text.completed{
text-decoration:line-through;
color:#999;
}
.due-time{font-size:0.8rem;color:#555}
.course-label{font-size:0.75rem;color:#764ba2}
.task-actions{margin-left:auto;display:flex;gap:8px}
button{cursor:pointer;background:none;border:none}
.modal-overlay{
position:fixed;
inset:0;
background:rgba(0,0,0,0.5);
backdrop-filter:blur(6px);
display:none;
justify-content:center;
align-items:center;
}
.modal{
background:white;
padding:25px;
border-radius:16px;
width:90%;
max-width:400px;
}
.modal input,.modal select{
width:100%;
margin-bottom:12px;
padding:10px;
border-radius:10px;
border:2px solid #ddd;
}
.modal-actions{
display:flex;
justify-content:flex-end;
gap:10px;
}
.save-btn{
background:linear-gradient(135deg,#667eea,#764ba2);
color:white;
padding:8px 16px;
border-radius:10px;
}
.cancel-btn{
background:#eee;
padding:8px 16px;
border-radius:10px;
}
</style>
</head>
<body>

<div class="container">
<div class="header">
<h1>Hwork Tracker</h1>
<div class="clock">
<div id="time"></div>
<div id="date"></div>
</div>
</div>

<div class="input-container">
<input class="task-input" placeholder="What needs to be done?">
<input type="datetime-local" class="due-input">
<select id="courseSelect">
<option value="">No Section</option>
</select>
<button class="add-btn">Add</button>
</div>

<div class="filters">
<button class="filter-btn active" data-filter="all">All</button>
<button class="filter-btn" data-filter="active">Active</button>
<button class="filter-btn" data-filter="completed">Completed</button>
</div>

<div class="course-filters"></div>

<div style="text-align:center;margin-top:12px;">
<input id="newCourseInput" placeholder="Create new course or section name"
style="padding:8px;border-radius:10px;border:2px solid #ddd;">
<button id="addCourseBtn"
style="padding:8px 14px;border-radius:10px;border:none;background:#667eea;color:white;">
Add
</button>
</div>

<ul class="task-list"></ul>

<button id="toggleArchive"
style="margin-top:10px;padding:8px 16px;border-radius:12px;border:none;background:#764ba2;color:white;">
Show Archive
</button>

<ul class="archive-list" style="display:none;"></ul>
</div>

<div class="modal-overlay">
<div class="modal">
<h2>Edit Task</h2>
<input id="editInput">
<select id="editCourseSelect"></select>
<div class="modal-actions">
<button class="cancel-btn">Cancel</button>
<button class="save-btn">Save</button>
</div>
</div>
</div>

<script>
/* CLOCK */
const timeEl=document.getElementById('time');
const dateEl=document.getElementById('date');
function updateClock(){
const now=new Date();
timeEl.textContent=now.toLocaleTimeString();
dateEl.textContent=now.toLocaleDateString();
document.title="Hmwk Tracker - "+now.toLocaleTimeString();
}
setInterval(updateClock,1000);updateClock();

/* DATA */
let tasks=JSON.parse(localStorage.getItem('tasks'))||[];
let archive=JSON.parse(localStorage.getItem('archive'))||[];
let courses=JSON.parse(localStorage.getItem('courses'))||[];
let currentFilter='all';
let selectedCourse=null;
let editingId=null;

/* ELEMENTS */
const input=document.querySelector('.task-input');
const dueInput=document.querySelector('.due-input');
const addBtn=document.querySelector('.add-btn');
const list=document.querySelector('.task-list');
const filters=document.querySelectorAll('.filter-btn');
const courseFilters=document.querySelector('.course-filters');
const newCourseInput=document.getElementById('newCourseInput');
const addCourseBtn=document.getElementById('addCourseBtn');
const courseSelect=document.getElementById('courseSelect');
const modal=document.querySelector('.modal-overlay');
const editInput=document.getElementById('editInput');
const editCourseSelect=document.getElementById('editCourseSelect');
const saveBtn=document.querySelector('.save-btn');
const cancelBtn=document.querySelector('.cancel-btn');
const archiveList=document.querySelector('.archive-list');
const toggleArchiveBtn=document.getElementById('toggleArchive');

/* COURSES */
function saveCourses(){
localStorage.setItem('courses',JSON.stringify(courses));
}

function renderCourseDropdowns(){
courseSelect.innerHTML=`<option value="">No Section</option>`+
courses.map(c=>`<option value="${c}">${c}</option>`).join('');
editCourseSelect.innerHTML=courseSelect.innerHTML;
}

function renderCourses(){
courseFilters.innerHTML=courses.map(c=>`
<div class="course-tab ${selectedCourse===c?'active':''}" data-course="${c}">
${c}<span class="delete-course">‚úñ</span>
</div>`).join('');

document.querySelectorAll('.course-tab').forEach(tab=>{
tab.onclick=()=>{
selectedCourse=tab.dataset.course;
render();
renderCourses();
};
tab.querySelector('.delete-course').onclick=(e)=>{
e.stopPropagation();
courses=courses.filter(x=>x!==tab.dataset.course);
tasks.forEach(t=>{if(t.course===tab.dataset.course)t.course=null});
if(selectedCourse===tab.dataset.course)selectedCourse=null;
saveCourses();
save();
renderCourses();
renderCourseDropdowns();
};
});
}

addCourseBtn.onclick=()=>{
const name=newCourseInput.value.trim();
if(!name||courses.includes(name))return;
courses.push(name);
newCourseInput.value='';
saveCourses();
renderCourses();
renderCourseDropdowns();
};

/* TASKS */
function save(){
localStorage.setItem('tasks',JSON.stringify(tasks));
localStorage.setItem('archive',JSON.stringify(archive));
render();
}

function addTask(){
const text=input.value.trim();
if(!text)return;
tasks.unshift({
id:Date.now(),
text,
completed:false,
due:dueInput.value||null,
course:courseSelect.value||null
});
input.value='';
dueInput.value='';
courseSelect.value='';
save();
}

addBtn.onclick=addTask;
input.addEventListener('keydown',e=>e.key==='Enter'&&addTask());

filters.forEach(btn=>{
btn.onclick=()=>{
filters.forEach(b=>b.classList.remove('active'));
btn.classList.add('active');
currentFilter=btn.dataset.filter;
render();
};
});

function getTimeRemaining(due) {
    if (!due) return '';

    const now = new Date();
    const dueDate = new Date(due);

    const formattedDate = dueDate.toLocaleString([], {
        year: 'numeric',
        month: 'short',
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
    });

    const diff = dueDate - now;

    if (diff <= 0) return `Due: ${formattedDate} ‚è∞ Past due date`;

    const hours = Math.floor(diff / (1000 * 60 * 60));
    const minutes = Math.floor((diff / (1000 * 60)) % 60);
    const seconds = Math.floor((diff / 1000) % 60);

    return `Due: ${formattedDate} ‚è≥ ${hours}h ${minutes}m ${seconds}s`;
}
function render(){
let filtered=[...tasks];
if(currentFilter==='active')filtered=filtered.filter(t=>!t.completed);
if(currentFilter==='completed')filtered=filtered.filter(t=>t.completed);
if(selectedCourse)filtered=filtered.filter(t=>t.course===selectedCourse);

list.innerHTML=filtered.map(t=>`
<li class="task-item">
<input type="checkbox" ${t.completed?'checked':''} data-id="${t.id}">
<div>
<span class="task-text ${t.completed?'completed':''}">${t.text}</span>
<div class="due-time">${getTimeRemaining(t.due)}</div>
${t.course?`<div class="course-label">üìö ${t.course}</div>`:''}
</div>
<div class="task-actions">
<button data-edit="${t.id}">‚úèÔ∏è</button>
<button data-del="${t.id}">üóëÔ∏è</button>
</div>
</li>`).join('');

document.querySelectorAll('[data-id]').forEach(cb=>{
cb.onchange=()=>{const t=tasks.find(x=>x.id==cb.dataset.id);t.completed=!t.completed;save();};
});

document.querySelectorAll('[data-edit]').forEach(btn=>{
btn.onclick=()=>{
editingId=btn.dataset.edit;
const t=tasks.find(x=>x.id==editingId);
editInput.value=t.text;
editCourseSelect.value=t.course||'';
modal.style.display='flex';
};
});

document.querySelectorAll('[data-del]').forEach(btn=>{
btn.onclick=()=>{
const t=tasks.find(x=>x.id==btn.dataset.del);
archive.unshift({
    ...t,
    archivedAt: Date.now()
});
tasks=tasks.filter(x=>x.id!=btn.dataset.del);
save();
};
});
}

/* MODAL */
saveBtn.onclick=()=>{
const t=tasks.find(x=>x.id==editingId);
if(t&&editInput.value.trim()){
t.text=editInput.value.trim();
t.course=editCourseSelect.value||null;
}
modal.style.display='none';
save();
};
cancelBtn.onclick=()=>modal.style.display='none';
modal.onclick=e=>{if(e.target===modal)modal.style.display='none'};

/* ARCHIVE */
let archiveVisible=false;
toggleArchiveBtn.onclick=()=>{
archiveVisible=!archiveVisible;
archiveList.style.display=archiveVisible?'block':'none';
toggleArchiveBtn.textContent=archiveVisible?'Hide Archive':'Show Archive';
archiveList.innerHTML=archive.map(t=>`
<li class="task-item" style="opacity:0.7;">
${t.text}
<div class="due-time">
üóëÔ∏è Auto deletes in ${Math.max(
    0,
    Math.ceil((24 * 60 * 60 * 1000 - (Date.now() - t.archivedAt)) / (60 * 60 * 1000))
)} hrs
</div>
</li>`).join('');
};
function cleanArchive() {
    const DAY = 24 * 60 * 60 * 1000;
    const now = Date.now();

    archive = archive.filter(t =>
        t.archivedAt && now - t.archivedAt < DAY
    );

    localStorage.setItem('archive', JSON.stringify(archive));
}
/* INIT */
renderCourses();
renderCourseDropdowns();
render();
cleanArchive();
setInterval(cleanArchive, 60 * 60 * 1000); // every hour
setInterval(() => {
    if (tasks.some(t => t.due && !t.completed)) {
        render();
    }
}, 1000);
</script>

</body>
</html>